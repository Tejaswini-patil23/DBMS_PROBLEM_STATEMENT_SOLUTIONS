CREATE TABLE stud (
    roll        NUMBER(5) PRIMARY KEY,
    name        VARCHAR2(30),
    attendance  NUMBER(5),
    status      VARCHAR2(20)
);


INSERT INTO stud VALUES (1, 'Teju', 80, NULL);
INSERT INTO stud VALUES (2, 'Riya', 60, NULL);
INSERT INTO stud VALUES (3, 'Amit', 75, NULL);
COMMIT;



DECLARE
    v_roll       NUMBER(5);
    v_attendance NUMBER(5);
BEGIN
    -- Accept roll number from user
    v_roll := &roll;   -- substitution variable (user input)

    -- Fetch attendance for that roll number
    SELECT attendance 
    INTO v_attendance
    FROM stud
    WHERE roll = v_roll;

    -- Check attendance condition
    IF v_attendance < 75 THEN
        DBMS_OUTPUT.PUT_LINE('Term not granted');
        UPDATE stud
        SET status = 'Detained'
        WHERE roll = v_roll;
    ELSE
        DBMS_OUTPUT.PUT_LINE('Term granted');
        UPDATE stud
        SET status = 'Not Detained'
        WHERE roll = v_roll;
    END IF;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('Error: Roll number not found.');
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('An unexpected error occurred: ' || SQLERRM);
END;
/
